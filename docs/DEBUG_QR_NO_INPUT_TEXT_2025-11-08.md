# –û—Ç–ª–∞–¥–∫–∞ –æ—à–∏–±–∫–∏ "No input text" - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
**–î–∞—Ç–∞:** 8 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** üîß –í –ø—Ä–æ—Ü–µ—Å—Å–µ –æ—Ç–ª–∞–¥–∫–∏

## –ü—Ä–æ–±–ª–µ–º–∞

–û—à–∏–±–∫–∞ –≤—Å—ë –µ—â—ë –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤ production:
```
PDF add QR error: Error: No input text
    at QRCode.toDataURL()
```

## –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–¥–µ (v2):

1. **labelPrinter.ts - renderTemplateToPdf() (—Å—Ç—Ä–æ–∫–∞ ~415)**
   ```typescript
   // –î–æ–±–∞–≤–ª–µ–Ω–∞ –î–í–û–ô–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞
   if (!qrContent || qrContent.trim() === '') {
     qrContent = productData.qrCode || productData.name || productData.barcode || 'LABEL';
   }
   
   // ‚úÖ –ù–û–í–ê–Ø: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
   if (!qrContent || qrContent.trim() === '' || qrContent === 'undefined' || qrContent === 'null') {
     qrContent = 'LABEL-' + Date.now();
     console.warn('QR content was empty, using fallback:', qrContent);
   }
   ```

2. **labelPrinter.ts - buildProductExtras() (—Å—Ç—Ä–æ–∫–∞ ~90)**
   ```typescript
   // –§–æ—Ä–º–∏—Ä—É–µ–º qrCode
   let qrCode = toStr(product?.qrCode ?? product?.qr_code ?? ...);
   
   // ‚úÖ –ù–û–í–ê–Ø: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ toStr()
   if (!qrCode || qrCode.trim() === '' || qrCode === 'PRODUCT-UNKNOWN') {
     qrCode = `LABEL-${Date.now()}`;
     console.warn('QR code was empty, using timestamp fallback:', qrCode);
   }
   ```

3. **labelPrinter.ts - exportLabelToPdf() (—Å—Ç—Ä–æ–∫–∞ ~521)**
   ```typescript
   // ‚úÖ –ù–û–í–ê–Ø: –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ safeQrCode
   const safeQrCode = product.barcode || product.qrCode || product.qr_code || 
                      product.sku || product.name || `PRODUCT-${product.id || Date.now()}`;
   
   const defaultPayload = {
     type: 'product',
     id: product.id,
     qrCode: safeQrCode,  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
     action: 'export-label',
   };
   ```

4. **labelPrinter.ts - renderTemplateToPdf() –Ω–∞—á–∞–ª–æ (—Å—Ç—Ä–æ–∫–∞ ~258)**
   ```typescript
   // ‚úÖ –ù–û–í–û–ï: –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
   console.log('renderTemplateToPdf - productData:', {
     qrCode: productData.qrCode,
     name: productData.name,
     barcode: productData.barcode,
     SKU: productData.SKU,
     hasQrCode: !!productData.qrCode,
     qrCodeLength: productData.qrCode?.length
   });
   ```

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞

–í DevTools (F12) ‚Üí Console

### –®–∞–≥ 2: –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å PDF

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –û–ø–µ—Ä–∞—Ç–æ—Ä
2. –û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ/–≤–≤–µ–¥–∏—Ç–µ QR —Ç–æ–≤–∞—Ä–∞
3. –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å PDF"

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
renderTemplateToPdf - productData: {
  qrCode: "SKU-10001",      // –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ù–ï –ø—É—Å—Ç—ã–º!
  name: "–¢—É–º–±–∞",
  barcode: "...",
  SKU: "SKU-10001",
  hasQrCode: true,
  qrCodeLength: 9
}
```

**–ï—Å–ª–∏ `qrCode` –ø—É—Å—Ç–æ–π –∏–ª–∏ `hasQrCode: false`:**
- –ü—Ä–æ–±–ª–µ–º–∞ –≤ –ø–µ—Ä–µ–¥–∞—á–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Operator.tsx
- –ü—Ä–æ–±–ª–µ–º–∞ –≤ buildProductExtras()

**–ï—Å–ª–∏ `qrCode` –ù–ï –ø—É—Å—Ç–æ–π, –Ω–æ –æ—à–∏–±–∫–∞ –≤—Å—ë —Ä–∞–≤–Ω–æ –µ—Å—Ç—å:**
- –ü—Ä–æ–±–ª–µ–º–∞ –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ QR
- –í–æ–∑–º–æ–∂–Ω–æ, –æ—à–∏–±–∫–∞ –≤ —à–∞–±–ª–æ–Ω–µ (element.dataField —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ)

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

–ï—Å–ª–∏ —É–≤–∏–¥–∏—Ç–µ:
```
‚ö†Ô∏è QR content was empty, using fallback: LABEL-1699445678901
‚ö†Ô∏è QR code was empty, using timestamp fallback: LABEL-1699445678902
```

–ó–Ω–∞—á–∏—Ç, —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. –¢–æ–≤–∞—Ä –±—ã–ª —Å–æ–∑–¥–∞–Ω –±–µ–∑ QR/SKU/barcode/name!

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ –æ—à–∏–±–∫–µ

### –°–ª—É—á–∞–π 1: –û—à–∏–±–∫–∞ "No input text" —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ª–æ–≥–æ–≤
```javascript
renderTemplateToPdf - productData: { qrCode: "", ... }  // –ü—É—Å—Ç–æ–π!
PDF add QR error: Error: No input text
```
**–ü—Ä–∏—á–∏–Ω–∞:** `productData.qrCode` –ø—É—Å—Ç–æ–π  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å buildProductExtras() –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ fallback —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°–ª—É—á–∞–π 2: –û—à–∏–±–∫–∞ –ë–ï–ó –ª–æ–≥–æ–≤
```javascript
PDF add QR error: Error: No input text
```
**–ü—Ä–∏—á–∏–Ω–∞:** –õ–æ–≥–∏ –Ω–µ –ø–æ—è–≤–∏–ª–∏—Å—å - –∑–Ω–∞—á–∏—Ç –æ—à–∏–±–∫–∞ –ù–ï –≤ renderTemplateToPdf  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ –º–µ—Å—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ QR (handleSavePDF –≤ Operator.tsx)

### –°–ª—É—á–∞–π 3: –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π qrCode, –Ω–æ –æ—à–∏–±–∫–∞ –µ—Å—Ç—å
```javascript
renderTemplateToPdf - productData: { qrCode: "SKU-10001", hasQrCode: true }
PDF add QR error: Error: No input text
```
**–ü—Ä–∏—á–∏–Ω–∞:** –®–∞–±–ª–æ–Ω —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ `element.dataField`, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —à–∞–±–ª–æ–Ω, –∫–∞–∫–∏–µ –ø–æ–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è QR

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤

–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –≤ —à–∞–±–ª–æ–Ω–µ, –æ—Ç–∫—Ä–æ–π—Ç–µ —à–∞–±–ª–æ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```sql
-- –ß–µ—Ä–µ–∑ Cloudflare Dashboard ‚Üí D1 ‚Üí Console
SELECT id, name, template_data 
FROM templates 
WHERE status = 'active';
```

–ù–∞–π–¥–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å `type: 'qrcode'`:
```json
{
  "type": "qrcode",
  "dataField": "someField",  // –≠—Ç–æ –ø–æ–ª–µ –¥–æ–ª–∂–Ω–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ productData!
  "content": "{{someField}}" // –ò–ª–∏ —ç—Ç–æ
}
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `dataField` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–¥–Ω–æ–º—É –∏–∑:
- `qrCode` ‚úÖ
- `name` ‚úÖ
- `barcode` ‚úÖ
- `SKU` ‚úÖ
- `productName` ‚úÖ

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –ø–æ–ª–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä `dataField: "customQR"`, –Ω–æ –≤ `productData` –Ω–µ—Ç `customQR`, —Ç–æ –±—É–¥–µ—Ç –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞!

## –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –Ω–µ –∏—Å—á–µ–∑–∞–µ—Ç, –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤—Å–µ QR —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —à–∞–±–ª–æ–Ω–µ –Ω–∞:

```json
{
  "type": "qrcode",
  "dataField": "",           // –ü—É—Å—Ç–æ
  "content": "{{qrCode}}"    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å placeholder
}
```

–ò–ª–∏ –≤–æ–æ–±—â–µ —É–¥–∞–ª–∏—Ç—å `dataField` –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ `content`.

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∏ –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω (`npm run build`)
2. ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ (Ctrl+Shift+R)
3. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
4. ‚è≥ –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è - –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ª–æ–≥–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

- ‚úÖ `src/lib/labelPrinter.ts` - 4 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è + –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ü—Ä–æ–µ–∫—Ç —Å–æ–±—Ä–∞–Ω

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫

- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ renderTemplateToPdf
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ buildProductExtras
- [x] –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ exportLabelToPdf
- [x] –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –Ω–∞—á–∞–ª–µ renderTemplateToPdf
- [x] –ü—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω
- [ ] –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ production
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –≤ –∫–æ–Ω—Å–æ–ª–∏

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É (Ctrl+Shift+R) –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å PDF. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –∏ —Å–æ–æ–±—â–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
